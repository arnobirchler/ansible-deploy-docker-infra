import os

from pymongo import MongoClient


def main():
    mongo_uri = mongodb://{{mongo_domain}}:27017
    db_name = os.environ.get('MONGO_DBNAME', 'orcl')
    collections = os.environ.get(
        'MONGO_COLLECTIONS',
        'orders,candies,capacities').split(',')

    client = MongoClient(mongo_uri)

    for collection in collections:
        print(client[db_name][collection].create_index([
            ('fingerprint', 'text')
        ], unique=True))


if __name__ == '__main__':
    main()
